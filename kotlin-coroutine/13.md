# 13장 코루틴 스코프 만들기

## CoroutineScope 팩토리 함수

* CoroutineScope는 coroutineContext를 유일한 프로퍼티로 가지고 있는 인터페이스

```kotlin
public interface CoroutineScope {
    public val coroutineContext: CoroutineContext
}
```

* CoroutineScope 인터페이스를 구현하는 클래스를 만들어서 사용해도 될까?
  * 안됨! - 해당 클래스에서 cancel 이나 ensureActive 같은 다른 CoroutineScope의 메서드를 직접 호출하면 문제가 발생할 수 있음 & 취소하면 이후 재시작을 할 수가 없음
  * 대신 코루틴 스코프 인스턴스를 프로퍼티로 가지고 있다가 코루틴 빌더 호출할 때 사용할 수 있음

```kotlin
// 잘못된 사용 방법
class SomeClass: CoroutineScope {
    override val coroutineContext: CoroutineContext = Job()
    
    fun onStart() {
        launch {
         // ...
        }
    }
}

// 대신 이렇게 사용하기
class SomeClass {
    val scope: CoroutineScope = ... // 코루틴 스코프 인스턴스
    
    fun onStart() {
        scope.launch { // 코루틴 빌더 호출 시 사용하기
            // ...
        }
    }
}
```

### CoroutineScope 팩토리 함수 사용하기 (가짜 생성자)

* 코루틴 스코프 객체를 만드는 가장 쉬운 방식!&#x20;
* 컨텍스트를 넘겨받아 스코프를 만든다 (Job이 없으면 Job을 추가할 수도 있음)

```kotlin
public fun CoroutineScope(
    context: CoroutineContext
): CoroutineScope = 
    ContextScope(if(context[Job] != null) context else context + Job())
    
internal class ContextScope(
    context: CoroutineContext
): CoroutineScope {
    override val coroutineContext = context
    override fun toString() = "CoroutineScope(coroutineContext=$coroutineContext)"
}
```

## 안드로이드에서 스코프 만들기



## viewModelScope 와 lifecycleScope



## 추가적인 호출을 위한 스코프 만들기
